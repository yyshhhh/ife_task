<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>color picker</title>
    <style type="text/css">

        #cont{position: relative; background-color: #737373; height: 320px; width:500px;}
        #cont #picker{position: absolute; left: 10px; top:10px; width:300px; height: 300px; background-color: #ff0000;}
        #cont #slider{position: absolute; left: 330px; top:10px;}
        #cont #color{position: absolute; left: 380px; bottom: 10px; color: white; font-family: Microsoft Yahei;}
        #cont #color label{display: block; margin-bottom: 8px; height: 20px;}
        #cont #color label span{display: inline-block; width: 20px;}
        #cont #color label input{ width: 40px;}





    </style>


</head>
<body>

    <div id="cont">

        <div id="picker">
            <svg  xmlns="http://www.w3.org/2000/svg" width="300px" height="300px" version="1.1">
                <defs>
                    <linearGradient id="gradient-black" x1="0%" y1="100%" x2="0%" y2="0%">
                        <stop offset="0%" stop-color="#000000" stop-opacity="1"></stop>
                        <stop offset="100%" stop-color="#ffffff" stop-opacity="0"></stop>
                    </linearGradient>
                    <linearGradient id="gradient-white" x1="0%" y1="100%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffffff" stop-opacity="1"></stop>
                        <stop offset="100%" stop-color="#ffffff" stop-opacity="0"></stop>
                    </linearGradient>
                </defs>
                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-white)"></rect>
                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-black)"></rect>
            </svg>
        </div>

        <div id="slider">
            <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="300px" version="1.1">
                <defs>
                    <linearGradient id="gradient-hsv" x1="0%" y1="100%" x2="0%" y2="0%">
                        <stop offset="0%" stop-color="#ff0000" stop-opacity="1"></stop>
                        <stop offset="8%" stop-color="#ff7f00" stop-opacity="1"></stop>
                        <stop offset="17%" stop-color="#ffff00" stop-opacity="1"></stop>
                        <stop offset="25%" stop-color="#80ff00" stop-opacity="1"></stop>
                        <stop offset="33%" stop-color="#00ff00" stop-opacity="1"></stop>
                        <stop offset="42%" stop-color="#00ff80" stop-opacity="1"></stop>
                        <stop offset="50%" stop-color="#00ffff" stop-opacity="1"></stop>
                        <stop offset="58%" stop-color="#0080ff" stop-opacity="1"></stop>
                        <stop offset="67%" stop-color="#0000ff" stop-opacity="1"></stop>
                        <stop offset="75%" stop-color="#8000ff" stop-opacity="1"></stop>
                        <stop offset="83%" stop-color="#ff00ff" stop-opacity="1"></stop>
                        <stop offset="92%" stop-color="#ff007f" stop-opacity="1"></stop>
                        <stop offset="100%" stop-color="#ff0000" stop-opacity="1"></stop>
                    </linearGradient>
                </defs>
                <rect width="30px" height="300px" fill="url(#gradient-hsv)">
            </svg>
        </div>

        <div id="numbers">
            <label><span>H</span><input type="" name="" id="h"> 度</label>
            <label><span>S</span><input type="" name="" id="s"> %</label>
            <label><span>B</span><input type="" name="" id="v"> %</label>
            <label><span>R</span><input type="" name="" id="r"></label>
            <label><span>G</span><input type="" name="" id="g"></label>
            <label><span>B</span><input type="" name="" id="b"></label>
            <label><span>#</span><input type="" name="" id="hex"></label>
        </div>

    </div>

    <script type="text/javascript">
        var cont = document.getElementById('cont');

        function colorPicker(){
            //判断是svg还是vml还是svgAngle
            var type = window.SVGAngle || documentimplementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1") ? "SVG" : "VML",
                picker, slide, hueOffset = 15, svgNS = 'http://www.w3.org/2000/svg';
            var colorpickerHTMLSnippet = [

                '<div class="picker-wrapper">',
                        '<div class="picker"></div>',
                        '<div class="picker-indicator"></div>',
                '</div>',
                '<div class="slide-wrapper">',
                        '<div class="slide"></div>',
                        '<div class="slide-indicator"></div>',
                '</div>'

            ].join('');

            function mousePosition(evt) {
                // IE:
                if (window.event && window.event.contentOverflow !== undefined) {
                    return { x: window.event.offsetX, y: window.event.offsetY };
                }
                // Webkit:
                if (evt.offsetX !== undefined && evt.offsetY !== undefined) {
                    return { x: evt.offsetX, y: evt.offsetY };
                }
            }

            //从hsv得到rbg的值
            function hsv2rgb(color){
                var R,G,B,h,f,p,q,t,r,g,b;
                h = (color.h / 60) % 6;
                f = color.h / 60 - h;
                p = color.v * (1 - color.s);
                q = color.v * (1- f * color.s);
                t = color.v * (1- (1 - f) * color.s);
                R = [v, q, p, p, t, v][h];
                G = [t, v, v, q, p, p][h];
                B = [p, p, t, v, v, q][h];
                r = Math.round( R * 255 );
                g = Math.round( G * 255 );
                b = Math.round( B * 255 );
                color.r = r;
                color.g = g;
                color.b = b;
                color.hex = Number( parseInt(r, 16).toString + parsrInt(g, 16).toString + parseInt(b, 16).toString );
            }

            //从rgb得到hsv的值
            function rgb2hsv(color){
                var r = color.r / 255,
                    b = color.b / 255,
                    g = color.g / 255;
                var h, s, v, H, S ,V;
                v = Math.max(r, g, b);
                min = Math.min(r, g, b);
                s =  v == 0 ? 0 : (v - min) / v;
                if ( v == r && g >= b ){
                    h = 60 * ( g - b ) / ( v - min);
                }
                else if ( v == r && g < b ){
                    h = 60 * ( g - b ) / ( v - min) + 360;
                }
                else if ( v == g ){
                    h = 60 * ( b - r ) / ( v - min) + 120;
                }
                else if ( v == b ){
                    h = 60 * ( r - g ) / ( v - min) + 240;
                }
                H = parseInt(h * 100);
                S = parseInt(s * 100);
                V = parseInt(v * 100);
                color.h = H;
                color.s = S;
                color.v = V;
                color.hex = Number( parseInt(color.r, 16).toString + parsrInt(color.g, 16).toString + parseInt(color.b, 16).toString );


            }

            //跨浏览器事件处理
            var EventUtil = {

                addHandler: function(element, type, handler){
                    if (element.addEventListener){
                        element.addEventListener(type, handler, false);
                    } else if (element.attachEvent){
                        element.attachEvent("on" + type, handler);
                    } else {
                        element["on" + type] = handler;
                    }
                },
                removeHandler: function(element, type, handler){
                    if (element.removeEventListener){
                        element.removeEventListener(type, handler, false);
                    } else if (element.detachEvent){
                        element.detachEvent("on" + type, handler);
                    } else {
                        element["on" + type] = null;
                    }
                }

            };

            //根据slide得到色相，并且反应到colorpicker上
            function slideListener(color, slideElement, pickerElement){
                return function(evt){
                    evt = evt || window.event;
                    var mouse = mousePosition(evt);
                    color.h = mouse.y / slideElement.offsetHeight * 360;
                    var pickerColor = hsv2rgb({h: color.h, s: 1, v: 1});
                    pickerElement.style.backgroundColor = pickerColor.hex;
                };
            }

            //根据picker的鼠标位置取到颜色值
            function pickListener(color, pickerElement){
                return funtion(evt){
                    evt = evt || window.event;
                    var mouse = mousePosition(evt),
                        width = pickerElement.offsetWidth,
                        height = pickerElement.offsetHeight;
                    color.s = mouse.x / width;
                    color.v = (height - mouse.y) / height;
                    var c = hsv2rgb(color);
                    getElementById('h').value = color.h;
                    getElementById('s').value = color.s;
                    getElementById('v').value = color.v;
                    getElementById('r').value = color.r;
                    getElementById('g').value = color.g;
                    getElementById('b').value = color.b;
                    getElementById('hex').value = color.hex;

                };
            }







        }


    </script>
</body>
</html>